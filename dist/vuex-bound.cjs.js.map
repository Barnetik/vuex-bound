{"version":3,"file":"vuex-bound.cjs.js","sources":["../src/index.js"],"sourcesContent":["// @flow\n\nexport const normalizeMap = (map: string[] | Object) => (\n  Array.isArray(map)\n    ? map.map(key => ({ key, val: key }))\n    : Object.keys(map).map(key => ({ key, val: map[key] }))\n);\n\nexport const normalizeNamespace = func =>\n  (namespace, map) => {\n    if (typeof namespace !== 'string') {\n      map = namespace;\n      namespace = '';\n    }\n\n    return func(namespace, map);\n  };\n\nexport const mapModel = normalizeNamespace((namespace, models) => {\n  const res = {};\n\n  normalizeMap(models).forEach(({ key, val }) => {\n    res[key] = {\n      get() {\n        if (!namespace) {\n          const globalState = this.$store.state;\n\n          if (typeof val === 'function') return val(globalState);\n          return globalState[key];\n        }\n\n        const moduleState = namespace.split('/')\n          .reduce((prev, cur) => prev[cur], this.$store.state);\n\n        if (typeof val === 'function') return val(moduleState);\n        return moduleState[key];\n      },\n      set(value) {\n        const type = !namespace ? 'updateModel' : `${namespace.split('/').join('/')}/updateModel`;\n\n        const valify = String(val);\n        const originState = valify.substring(valify.indexOf('.') + 1, valify.indexOf(';'));\n\n        this.$store.commit(type, { label: originState || key, value });\n      },\n    };\n  });\n\n  return res;\n});\n\nexport const updateModel = () => ({\n  updateModel(state, { label, value }) {\n    if (label.includes('.')) {\n      const labelKeys = label.split('.')\n        .map((lk) => {\n          const arr = [];\n\n          if (/\\[\\d\\]/g.test(lk)) {\n            const lkString = lk.substring(lk.length - 3, -1);\n            const lkIndex = lk.slice(-2, -1);\n\n            arr.push(lkString, lkIndex);\n          } else {\n            arr.push(lk);\n          }\n\n          return arr;\n        })\n        .reduce((acc, cur) => acc.concat(cur), []);\n\n      for (let i = 0; i < labelKeys.length - 1; i += 1) {\n        state = state[labelKeys[i]];\n      }\n\n      state[labelKeys[labelKeys.length - 1]] = value;\n    } else {\n      state[label] = value;\n    }\n  },\n});\n"],"names":["normalizeMap","map","Array","isArray","key","val","Object","keys","normalizeNamespace","namespace","func","mapModel","models","res","forEach","globalState","$store","state","moduleState","split","reduce","prev","cur","value","type","join","valify","String","originState","substring","indexOf","commit","label","updateModel","includes","labelKeys","lk","arr","test","lkString","length","lkIndex","slice","push","acc","concat","i"],"mappings":"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"}